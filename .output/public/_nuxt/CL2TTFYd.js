import{a as I}from"./B7Z6bEOo.js";import{D as E}from"./BCLI-N1p.js";import{d as k,r as v,j as M,h as w,Q as T,G as F,v as C,L as O,B as d,y as N,A as u,M as e,S,_ as D,C as U,z as A,x as B,R as q}from"./BlwiRDIC.js";import{N as V}from"./B6U3m7cM.js";import{_ as $}from"./Bz78ND71.js";import{_ as z}from"./DuSjmB3v.js";import{_ as P,a as j}from"./6xL-_iDX.js";import{R as x,u as R}from"./DjCO3r1X.js";import{u as G}from"./BoKg0mNg.js";import"./BL72AHmw.js";import"./B-p6aW7q.js";import"./DhzzdqlV.js";import"./ChGy5axL.js";import"./D0iCcIcp.js";import"./afXVeJPx.js";import"./D_cWMoAv.js";import"./BFbf3kA_.js";import"./BBUvRIjv.js";import"./tlPEdBaS.js";import"./Bk_rJcZu.js";const H={class:"notification-table"},J=k({__name:"Table",props:{data:{type:Array,required:!0,default:()=>[]}},emits:["row-click","delete-row"],setup(b,{emit:s}){const o=s,_=b,a=v([]),n=I(),m=M(()=>[{title:n.translate("title"),width:200,key:"title"},{title:n.translate("body"),width:300,key:"body"},{title:"",key:"actions",width:100,render(l){return w(T,{size:"small",type:"error",strong:!0,onClick:i=>{i.stopPropagation(),o("delete-row",l)}},{icon:()=>w(V,null,{default:()=>w(E)})})}}]),f=l=>({style:"cursor: pointer;",onClick:()=>{o("row-click",l)}});return F(()=>_.data,l=>{a.value=l}),(l,i)=>{const r=$,t=S;return C(),O(t,{size:"small",class:"container"},{default:d(()=>[N("div",H,[u(r,{columns:e(m),data:e(a),bordered:!1,pagination:!1,"row-props":f,"max-height":"calc(100vh - 304px)"},null,8,["columns","data"])])]),_:1})}}}),L=D(J,[["__scopeId","data-v-f728bfb1"]]),Q=k({__name:"Form",props:{form:{type:Object,default:()=>({})}},emits:["update:form"],setup(b,{emit:s}){const o=b,_=s,a=I(),n=v({title:o.form.title,body:o.form.body}),m=v(null);F(()=>o.form,i=>{n.value.title=i.title,n.value.body=i.body},{deep:!0});const f={title:{required:!0,message:a.translate("title_is_required"),trigger:"blur"},body:{required:!0,message:a.translate("body_is_required"),trigger:"blur"}},l=i=>{var r;i.preventDefault(),(r=m.value)==null||r.validate(t=>{t||_("update:form",n.value)})};return(i,r)=>{const t=z,c=P,p=T,y=j,h=S;return C(),O(h,null,{default:d(()=>[u(y,{model:e(n),rules:f,ref_key:"formRef",ref:m},{default:d(()=>[u(c,{label:e(a).translate("title"),prop:"title",path:"title"},{default:d(()=>[u(t,{value:e(n).title,"onUpdate:value":r[0]||(r[0]=g=>e(n).title=g),placeholder:e(a).translate("please_input")},null,8,["value","placeholder"])]),_:1},8,["label"]),u(c,{label:e(a).translate("body"),prop:"body",path:"body"},{default:d(()=>[u(t,{value:e(n).body,"onUpdate:value":r[1]||(r[1]=g=>e(n).body=g),placeholder:e(a).translate("please_input")},null,8,["value","placeholder"])]),_:1},8,["label"]),u(c,null,{default:d(()=>[u(p,{type:"primary",onClick:l},{default:d(()=>[U(A(e(a).translate("send")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),W={class:"container"},K={class:"form-container"},X=k({__name:"notifications",setup(b){const s=v({title:"",body:""}),o=v([]),_=G(),a=t=>{s.value.title=t.title,s.value.body=t.body},n=x.MOVEMENT_NOTIFICATIONS,m=R(n),f={all:!0,limit:20,where:JSON.stringify([{key:"user_id",value:_.authUser.id}])},l=async()=>{try{const t=await m.browse(f,!1);o.value=t,console.log(o.value)}catch(t){console.error("Error fetching notification:",t)}},i=async t=>{const c={...t,user_id:_.authUser.id};try{console.log("Form updated Final:",c);const p=await m.save(c);p&&(o.value.unshift(p),s.value={title:"",body:""})}catch(p){console.error("Error saving notification:",p)}},r=async t=>{console.log("Deleting row:",t),await R(x.MOVEMENT_NOTIFICATIONS,t.id).delete(!0)&&(o.value=o.value.filter(y=>y.id!==t.id))};return l(),(t,c)=>{const p=L,y=Q;return C(),B("div",W,[N("div",null,[u(p,{data:e(o),onRowClick:a,onDeleteRow:r},null,8,["data"])]),N("div",K,[u(y,{form:e(s),"onUpdate:form":[c[0]||(c[0]=h=>q(s)?s.value=h:null),i]},null,8,["form"])])])}}}),bt=D(X,[["__scopeId","data-v-e04ecca3"]]);export{bt as default};
