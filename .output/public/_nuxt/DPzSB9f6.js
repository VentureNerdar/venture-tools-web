import{u as z,R as k}from"./iRh0XMeS.js";import{b as E}from"./C45RVbce.js";import{a as A,N as F,b as L,u as se}from"./CIpPGm0y.js";import{J as re,K as B,L as b,M as v,N as T,m as P,O as ie,D,P as de,q as S,F as j,o as U,c as I,a as q,n as H,b as t,w as a,u as e,d as y,t as x,B as W,v as J,Q as ce,r as V,p as ue,_ as pe}from"./BxpEjOof.js";import{_ as me,u as _e,a as fe}from"./CMx4vCqV.js";import{_ as G}from"./CdbiR7o9.js";import{_ as ge}from"./CStkqZVZ.js";import{_ as ve,u as he}from"./Bh-dvM22.js";import{_ as K}from"./Ddphtmyl.js";import{u as be}from"./CkJRSCI6.js";import{b as we}from"./Cm9BH2tJ.js";import{a as ye,_ as xe}from"./Sh7brP6T.js";import{_ as Ce,a as Se}from"./CFtEhxhO.js";import{_ as ze}from"./BeQTrYKT.js";import{_ as ke}from"./B3GtHJNu.js";import{_ as Pe}from"./BUV_O0Pv.js";import"./CiZFtKuk.js";import"./Br6dbfou.js";import"./CAlQbQj8.js";import"./BYxb2o8q.js";const Ue=re("divider",`
 position: relative;
 display: flex;
 width: 100%;
 box-sizing: border-box;
 font-size: 16px;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
`,[B("vertical",`
 margin-top: 24px;
 margin-bottom: 24px;
 `,[B("no-title",`
 display: flex;
 align-items: center;
 `)]),b("title",`
 display: flex;
 align-items: center;
 margin-left: 12px;
 margin-right: 12px;
 white-space: nowrap;
 font-weight: var(--n-font-weight);
 `),v("title-position-left",[b("line",[v("left",{width:"28px"})])]),v("title-position-right",[b("line",[v("right",{width:"28px"})])]),v("dashed",[b("line",`
 background-color: #0000;
 height: 0px;
 width: 100%;
 border-style: dashed;
 border-width: 1px 0 0;
 `)]),v("vertical",`
 display: inline-block;
 height: 1em;
 margin: 0 8px;
 vertical-align: middle;
 width: 1px;
 `),b("line",`
 border: none;
 transition: background-color .3s var(--n-bezier), border-color .3s var(--n-bezier);
 height: 1px;
 width: 100%;
 margin: 0;
 `),B("dashed",[b("line",{backgroundColor:"var(--n-color)"})]),v("dashed",[b("line",{borderColor:"var(--n-color)"})]),v("vertical",{backgroundColor:"var(--n-color)"})]),$e=Object.assign(Object.assign({},T.props),{titlePlacement:{type:String,default:"center"},dashed:Boolean,vertical:Boolean}),Oe=P({name:"Divider",props:$e,setup(f){const{mergedClsPrefixRef:p,inlineThemeDisabled:s}=ie(f),o=T("Divider","-divider",Ue,we,f,p),n=D(()=>{const{common:{cubicBezierEaseInOut:d},self:{color:r,textColor:h,fontWeight:g}}=o.value;return{"--n-bezier":d,"--n-color":r,"--n-text-color":h,"--n-font-weight":g}}),u=s?de("divider",void 0,n,f):void 0;return{mergedClsPrefix:p,cssVars:s?void 0:n,themeClass:u==null?void 0:u.themeClass,onRender:u==null?void 0:u.onRender}},render(){var f;const{$slots:p,titlePlacement:s,vertical:o,dashed:n,cssVars:u,mergedClsPrefix:d}=this;return(f=this.onRender)===null||f===void 0||f.call(this),S("div",{role:"separator",class:[`${d}-divider`,this.themeClass,{[`${d}-divider--vertical`]:o,[`${d}-divider--no-title`]:!p.default,[`${d}-divider--dashed`]:n,[`${d}-divider--title-position-${s}`]:p.default&&s}],style:u},o?null:S("div",{class:`${d}-divider__line ${d}-divider__line--left`}),!o&&p.default?S(j,null,S("div",{class:`${d}-divider__title`},this.$slots),S("div",{class:`${d}-divider__line ${d}-divider__line--right`})):null)}}),Re={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Me=P({name:"CloudUploadRound",render:function(p,s){return U(),I("svg",Re,s[0]||(s[0]=[q("path",{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l4.65-4.65c.2-.2.51-.2.71 0L17 13h-3z",fill:"currentColor"},null,-1)]))}}),Ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Be=P({name:"WarningRound",render:function(p,s){return U(),I("svg",Ne,s[0]||(s[0]=[q("path",{d:"M4.47 21h15.06c1.54 0 2.5-1.67 1.73-3L13.73 4.99c-.77-1.33-2.69-1.33-3.46 0L2.74 18c-.77 1.33.19 3 1.73 3zM12 14c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm1 4h-2v-2h2v2z",fill:"currentColor"},null,-1)]))}}),Ee=P({__name:"ProfileChangePassword",setup(f){const p=E(),s=A(),o={updateProfile:z(k.USERS),changePassword:z(k.PROFILE_CHANGE_PASSWORD,0)},n=H({visibility:{modal:!1,confirm:!1},loading:{form:!1,buttonSave:!1,buttonCancel:!1},form:{current_password:"",new_password:"",confirm_new_password:""}}),u={handle:{click:{button:{modal:()=>{n.visibility.modal=!0},cancel:()=>{n.visibility.modal=!1,u.clearForm()},save:async()=>{n.loading.form=!0,n.loading.buttonSave=!0,n.loading.buttonCancel=!0,await u.consume.changePassword(),n.loading.form=!1,n.loading.buttonSave=!0,n.loading.buttonCancel=!0,n.visibility.modal=!1,u.clearForm()}}}},consume:{changePassword:async()=>{await o.changePassword.save(n.form)!==!1&&p.logout()}},clearForm:()=>{n.form.current_password="",n.form.new_password="",n.form.confirm_new_password=""}};return(d,r)=>{const h=F,g=W,w=me,C=G,$=ge,O=ve,R=K,c=J,l=ce;return U(),I(j,null,[t(g,{type:"error",secondary:"",onClick:u.handle.click.button.modal},{icon:a(()=>[t(h,{component:e(Be)},null,8,["component"])]),default:a(()=>[y(" "+x(e(s).translate("change_password")),1)]),_:1},8,["onClick"]),t(l,{show:e(n).visibility.modal,"onUpdate:show":r[3]||(r[3]=i=>e(n).visibility.modal=i),"transform-origin":"center"},{default:a(()=>[t(c,{style:{width:"600px"},title:e(s).translate("change_password"),size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[t(R,{justify:"end"},{default:a(()=>[t(g,{type:"default",size:"small",disabled:e(n).loading.buttonCancel,onClick:u.handle.click.button.cancel},{default:a(()=>[y(x(e(s).translate("cancel")),1)]),_:1},8,["disabled","onClick"]),t(g,{type:"primary",size:"small",disabled:e(n).loading.buttonSave,loading:e(n).loading.buttonSave,onClick:u.handle.click.button.save},{default:a(()=>[y(x(e(s).translate("save")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),default:a(()=>[t(O,{show:e(n).loading.form},{default:a(()=>[t($,{size:10,vertical:""},{default:a(()=>[t(w,{title:e(s).translate("you_will_need_to_log_in_again_after_you_chang_your_password"),type:"info"},null,8,["title"]),t(C,{size:"small",value:e(n).form.current_password,"onUpdate:value":r[0]||(r[0]=i=>e(n).form.current_password=i),type:"password",placeholder:e(s).translate("current_password")},null,8,["value","placeholder"]),t(C,{size:"small",value:e(n).form.new_password,"onUpdate:value":r[1]||(r[1]=i=>e(n).form.new_password=i),type:"password",placeholder:e(s).translate("new_password")},null,8,["value","placeholder"]),t(C,{size:"small",value:e(n).form.confirm_new_password,"onUpdate:value":r[2]||(r[2]=i=>e(n).form.confirm_new_password=i),type:"password",placeholder:e(s).translate("confirm_new_password")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["show"])]),_:1},8,["title"])]),_:1},8,["show"])],64)}}}),De=P({__name:"profile",setup(f){const p=E(),s=V(null),o=V({...p.authUser}),n=A(),d=be().isMobile,r=H({loading:{movements:!1,contacts:!1},options:{movements:[],contacts:[]}}),h={roles:he(),languages:L().languages,settingStore:se(),movementStore:_e(),contacts:fe().contacts},g={movements:z(k.MOVEMENTS),contacts:z(k.CONTACTS)},w={handle:{searchMovementsOption:async c=>{r.loading.movements=!0;const l=await g.movements.browse({all:!0,search_by:"name",search:c},!1);r.options.movements=[...l.map(i=>({label:i.name,value:i.id}))],r.loading.movements=!1},searchContactsOption:async c=>{r.loading.contacts=!0;const l=await g.contacts.browse({all:!0,search_by:"name",search:c},!1);r.options.contacts=[...l.map(i=>({label:i.name,value:i.id}))],r.loading.contacts=!1}},movementOptions:async()=>{const c=await g.movements.list({labelOption:"name",limit:20,existingID:o.value.movement_id});r.options.movements=[...c]},contactOptions:async()=>{const c=await g.contacts.list({labelOption:"name",limit:20,existingID:o.value.contact_id});r.options.contacts=[...c]}},C={user:{name:{required:!0,message:"Please input your name",trigger:"blur"},age:{required:!0,message:"Please input your age",trigger:["input","blur"]}},phone:{required:!0,message:"Please input your number",trigger:["input"]}},$=D(()=>L().languages.map(c=>({label:c.name,value:c.id}))),O=D(()=>{var c;return(c=h.roles.userRoles.find(l=>l.id===o.value.user_role_id))==null?void 0:c.label}),R=async()=>{await z(k.USERS,p.authUser.id).save(o.value);const i={...JSON.parse(localStorage.getItem("authUser")||"{}"),...o.value};E().authUser=i,localStorage.setItem("authUser",JSON.stringify(i));const _=h.languages.find(M=>M.id===o.value.preferred_language_id);_&&h.settingStore.setUserPreferredLanguage(_)};return w.movementOptions(),w.contactOptions(),(c,l)=>{const i=G,_=Ce,M=ze,N=ke,Q=Pe,X=F,Y=W,Z=K,ee=Se,ne=Oe,te=Ee,oe=J,ae=xe,le=ye;return U(),ue(le,{cols:e(d)?12:5,"y-gap":"10"},{default:a(()=>[t(ae,{class:"container",span:e(d)?12:3,offset:e(d)?0:1},{default:a(()=>[t(oe,{size:"small"},{default:a(()=>[t(ee,{ref_key:"formRef",ref:s,"label-width":80,model:e(o),rules:C,size:"small"},{default:a(()=>[t(_,{label:e(n).translate("name"),path:"name"},{default:a(()=>[t(i,{value:e(o).name,"onUpdate:value":l[0]||(l[0]=m=>e(o).name=m),placeholder:e(n).translate("input_name")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(_,{label:e(n).translate("role"),path:"user_role_id"},{default:a(()=>[t(M,{type:"info"},{default:a(()=>[y(x(e(O)),1)]),_:1})]),_:1},8,["label"]),t(_,{label:e(n).translate("email_address"),path:"email"},{default:a(()=>[t(i,{value:e(o).email,"onUpdate:value":l[1]||(l[1]=m=>e(o).email=m),placeholder:e(n).translate("input_email_address")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(_,{label:e(n).translate("phone_number"),path:"phone_number"},{default:a(()=>[t(i,{value:e(o).phone_number,"onUpdate:value":l[2]||(l[2]=m=>e(o).phone_number=m),placeholder:e(n).translate("input_phone_number")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(_,{label:e(n).translate("biography"),path:"biography"},{default:a(()=>[t(i,{value:e(o).biography,"onUpdate:value":l[3]||(l[3]=m=>e(o).biography=m),type:"textarea",placeholder:e(n).translate("input_biography")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(_,{label:e(n).translate("movement"),path:"movement_id"},{default:a(()=>[t(N,{value:e(o).movement_id,"onUpdate:value":l[4]||(l[4]=m=>e(o).movement_id=m),filterable:"",clearable:"",remote:"",placeholder:e(n).translate("select_movement"),options:e(r).options.movements,onSearch:w.handle.searchMovementsOption},null,8,["value","placeholder","options","onSearch"])]),_:1},8,["label"]),t(_,{path:"contact_id",label:e(n).translate("contact")},{default:a(()=>[t(N,{loading:e(r).loading.contacts,filterable:"",clearable:"",remote:"",onSearch:w.contactOptions,value:e(o).contact_id,"onUpdate:value":l[5]||(l[5]=m=>e(o).contact_id=m),options:e(r).options.contacts,placeholder:e(n).translate("please_select")},{action:a(()=>[t(Q,{depth:3},{default:a(()=>[y(x(e(n).translate("loading_maximum_20_users._type_in_the_name_of_the_user_to_search")),1)]),_:1})]),_:1},8,["loading","onSearch","value","options","placeholder"])]),_:1},8,["label"]),t(_,{label:e(n).translate("preferred_language"),path:"preferred_language_id"},{default:a(()=>[t(N,{value:e(o).preferred_language_id,"onUpdate:value":l[6]||(l[6]=m=>e(o).preferred_language_id=m),clearable:"",placeholder:e(n).translate("select_preferred_language"),options:e($)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(Z,{justify:"center"},{default:a(()=>[t(Y,{type:"warning",secondary:"",size:"small",onClick:R},{icon:a(()=>[t(X,{component:e(Me)},null,8,["component"])]),default:a(()=>[y(" "+x(e(n).translate("update")),1)]),_:1})]),_:1})]),_:1},8,["model"]),t(ne),t(_,{label:e(n).translate("change_password"),"label-placement":"left",size:"small"},{default:a(()=>[t(te)]),_:1},8,["label"])]),_:1})]),_:1},8,["span","offset"])]),_:1},8,["cols"])}}}),on=pe(De,[["__scopeId","data-v-969d7150"]]);export{on as default};
