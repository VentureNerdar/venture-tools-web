import{u as P,R as $}from"./DS-kRQLf.js";import{u as V}from"./DBXDjDBo.js";import{a as T,b as F,u as le}from"./C01nUmCt.js";import{V as se,W as M,X as h,Y as g,Z as j,d as S,$ as re,j as z,a0 as ie,h as C,N as D,v as R,x as E,y as I,K as de,A as n,B as o,M as e,C as b,z as w,Q as W,S as H,a1 as ue,r as k,L as ce}from"./GCT0zxdb.js";import{N as q}from"./DauuM1mT.js";import{_ as pe,u as _e,a as me}from"./C8nb4O2M.js";import{_ as J}from"./qjyT1jqi.js";import{_ as fe}from"./dY0Y4zfn.js";import{_ as ge,u as ve}from"./w4amTctl.js";import{_ as G}from"./D-bx17e_.js";import{b as he}from"./CpTsecKK.js";import{_ as be,a as we}from"./BMgvgue1.js";import{_ as ye,a as xe}from"./CowydaWF.js";import{_ as Ce}from"./rrzBb7gs.js";import{_ as Se}from"./DiMBbo-f.js";import{_ as Ue}from"./DIEtEZhr.js";import"./DcEpzLML.js";import"./DKN-R7U0.js";import"./B-p6aW7q.js";import"./B4q8ePhz.js";import"./BAqEG-yS.js";import"./Bk_rJcZu.js";import"./DHp01vku.js";const ke=se("divider",`
 position: relative;
 display: flex;
 width: 100%;
 box-sizing: border-box;
 font-size: 16px;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
`,[M("vertical",`
 margin-top: 24px;
 margin-bottom: 24px;
 `,[M("no-title",`
 display: flex;
 align-items: center;
 `)]),h("title",`
 display: flex;
 align-items: center;
 margin-left: 12px;
 margin-right: 12px;
 white-space: nowrap;
 font-weight: var(--n-font-weight);
 `),g("title-position-left",[h("line",[g("left",{width:"28px"})])]),g("title-position-right",[h("line",[g("right",{width:"28px"})])]),g("dashed",[h("line",`
 background-color: #0000;
 height: 0px;
 width: 100%;
 border-style: dashed;
 border-width: 1px 0 0;
 `)]),g("vertical",`
 display: inline-block;
 height: 1em;
 margin: 0 8px;
 vertical-align: middle;
 width: 1px;
 `),h("line",`
 border: none;
 transition: background-color .3s var(--n-bezier), border-color .3s var(--n-bezier);
 height: 1px;
 width: 100%;
 margin: 0;
 `),M("dashed",[h("line",{backgroundColor:"var(--n-color)"})]),g("dashed",[h("line",{borderColor:"var(--n-color)"})]),g("vertical",{backgroundColor:"var(--n-color)"})]),ze=Object.assign(Object.assign({},j.props),{titlePlacement:{type:String,default:"center"},dashed:Boolean,vertical:Boolean}),Pe=S({name:"Divider",props:ze,setup(f){const{mergedClsPrefixRef:p,inlineThemeDisabled:r}=re(f),l=j("Divider","-divider",ke,he,f,p),a=z(()=>{const{common:{cubicBezierEaseInOut:i},self:{color:m,textColor:y,fontWeight:v}}=l.value;return{"--n-bezier":i,"--n-color":m,"--n-text-color":y,"--n-font-weight":v}}),t=r?ie("divider",void 0,a,f):void 0;return{mergedClsPrefix:p,cssVars:r?void 0:a,themeClass:t==null?void 0:t.themeClass,onRender:t==null?void 0:t.onRender}},render(){var f;const{$slots:p,titlePlacement:r,vertical:l,dashed:a,cssVars:t,mergedClsPrefix:i}=this;return(f=this.onRender)===null||f===void 0||f.call(this),C("div",{role:"separator",class:[`${i}-divider`,this.themeClass,{[`${i}-divider--vertical`]:l,[`${i}-divider--no-title`]:!p.default,[`${i}-divider--dashed`]:a,[`${i}-divider--title-position-${r}`]:p.default&&r}],style:t},l?null:C("div",{class:`${i}-divider__line ${i}-divider__line--left`}),!l&&p.default?C(D,null,C("div",{class:`${i}-divider__title`},this.$slots),C("div",{class:`${i}-divider__line ${i}-divider__line--right`})):null)}}),$e={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Re=S({name:"CloudUploadRound",render:function(p,r){return R(),E("svg",$e,r[0]||(r[0]=[I("path",{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l4.65-4.65c.2-.2.51-.2.71 0L17 13h-3z",fill:"currentColor"},null,-1)]))}}),Be={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ne=S({name:"WarningRound",render:function(p,r){return R(),E("svg",Be,r[0]||(r[0]=[I("path",{d:"M4.47 21h15.06c1.54 0 2.5-1.67 1.73-3L13.73 4.99c-.77-1.33-2.69-1.33-3.46 0L2.74 18c-.77 1.33.19 3 1.73 3zM12 14c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm1 4h-2v-2h2v2z",fill:"currentColor"},null,-1)]))}}),Oe=S({__name:"ProfileChangePassword",setup(f){const p=V(),r=T(),l={updateProfile:P($.USERS),changePassword:P($.PROFILE_CHANGE_PASSWORD,0)},a=de({visibility:{modal:!1,confirm:!1},loading:{form:!1,buttonSave:!1,buttonCancel:!1},form:{current_password:"",new_password:"",confirm_new_password:""}}),t={handle:{click:{button:{modal:()=>{a.visibility.modal=!0},cancel:()=>{a.visibility.modal=!1,t.clearForm()},save:async()=>{a.loading.form=!0,a.loading.buttonSave=!0,a.loading.buttonCancel=!0,await t.consume.changePassword(),a.loading.form=!1,a.loading.buttonSave=!0,a.loading.buttonCancel=!0,a.visibility.modal=!1,t.clearForm()}}}},consume:{changePassword:async()=>{await l.changePassword.save(a.form)!==!1&&p.logout()}},clearForm:()=>{a.form.current_password="",a.form.new_password="",a.form.confirm_new_password=""}};return(i,m)=>{const y=q,v=W,U=pe,x=J,B=fe,N=ge,O=G,u=H,s=ue;return R(),E(D,null,[n(v,{type:"error",secondary:"",onClick:t.handle.click.button.modal},{icon:o(()=>[n(y,{component:e(Ne)},null,8,["component"])]),default:o(()=>[b(" "+w(e(r).translate("change_password")),1)]),_:1},8,["onClick"]),n(s,{show:e(a).visibility.modal,"onUpdate:show":m[3]||(m[3]=d=>e(a).visibility.modal=d),"transform-origin":"center"},{default:o(()=>[n(u,{style:{width:"600px"},title:e(r).translate("change_password"),size:"small",role:"dialog","aria-modal":"true"},{footer:o(()=>[n(O,{justify:"end"},{default:o(()=>[n(v,{type:"default",size:"small",disabled:e(a).loading.buttonCancel,onClick:t.handle.click.button.cancel},{default:o(()=>[b(w(e(r).translate("cancel")),1)]),_:1},8,["disabled","onClick"]),n(v,{type:"primary",size:"small",disabled:e(a).loading.buttonSave,loading:e(a).loading.buttonSave,onClick:t.handle.click.button.save},{default:o(()=>[b(w(e(r).translate("save")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),default:o(()=>[n(N,{show:e(a).loading.form},{default:o(()=>[n(B,{size:10,vertical:""},{default:o(()=>[n(U,{title:e(r).translate("you_will_need_to_log_in_again_after_you_chang_your_password"),type:"info"},null,8,["title"]),n(x,{size:"small",value:e(a).form.current_password,"onUpdate:value":m[0]||(m[0]=d=>e(a).form.current_password=d),type:"password",placeholder:e(r).translate("current_password")},null,8,["value","placeholder"]),n(x,{size:"small",value:e(a).form.new_password,"onUpdate:value":m[1]||(m[1]=d=>e(a).form.new_password=d),type:"password",placeholder:e(r).translate("new_password")},null,8,["value","placeholder"]),n(x,{size:"small",value:e(a).form.confirm_new_password,"onUpdate:value":m[2]||(m[2]=d=>e(a).form.confirm_new_password=d),type:"password",placeholder:e(r).translate("confirm_new_password")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["show"])]),_:1},8,["title"])]),_:1},8,["show"])],64)}}}),an=S({__name:"profile",setup(f){const p=V(),r=k(null),l=k({...p.authUser}),a=k(!1),t=T(),i={roles:ve(),languages:F().languages,settingStore:le(),movements:_e().movements,contacts:me().contacts},m={contacts:P($.CONTACTS)},y={user:{name:{required:!0,message:"Please input your name",trigger:"blur"},age:{required:!0,message:"Please input your age",trigger:["input","blur"]}},phone:{required:!0,message:"Please input your number",trigger:["input"]}},v=z(()=>F().languages.map(u=>({label:u.name,value:u.id}))),U=k(i.contacts.map(u=>({label:u.name,value:u.id}))),x=z(()=>{var u;return(u=i.roles.userRoles.find(s=>s.id===l.value.user_role_id))==null?void 0:u.label}),B=z(()=>i.movements.map(u=>({label:u.name,value:u.id}))),N=async u=>{a.value=!0;const s=await m.contacts.browse({all:!0,search_by:"name",search:u},!1);U.value=[...s.map(d=>({label:d.name,value:d.id}))],a.value=!1},O=async()=>{await P($.USERS,p.authUser.id).save(l.value);const d={...JSON.parse(localStorage.getItem("authUser")||"{}"),...l.value};V().authUser=d,localStorage.setItem("authUser",JSON.stringify(d));const _=i.languages.find(L=>L.id===l.value.preferred_language_id);_&&i.settingStore.setUserPreferredLanguage(_)};return(u,s)=>{const d=J,_=ye,L=Ce,A=Se,K=Ue,Q=q,X=W,Y=G,Z=xe,ee=Pe,ne=Oe,te=H,ae=we,oe=be;return R(),ce(oe,{"y-gap":"10",cols:"5"},{default:o(()=>[n(ae,{offset:1,span:3},{default:o(()=>[n(te,{size:"small"},{default:o(()=>[n(Z,{ref_key:"formRef",ref:r,"label-width":80,model:e(l),rules:y,size:"small"},{default:o(()=>[n(_,{label:e(t).translate("name"),path:"name"},{default:o(()=>[n(d,{value:e(l).name,"onUpdate:value":s[0]||(s[0]=c=>e(l).name=c),placeholder:e(t).translate("input_name")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("role"),path:"user_role_id"},{default:o(()=>[n(L,{type:"info"},{default:o(()=>[b(w(e(x)),1)]),_:1})]),_:1},8,["label"]),n(_,{label:e(t).translate("username"),path:"username"},{default:o(()=>[n(d,{value:e(l).username,"onUpdate:value":s[1]||(s[1]=c=>e(l).username=c),placeholder:e(t).translate("input_username")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("email_address"),path:"email"},{default:o(()=>[n(d,{value:e(l).email,"onUpdate:value":s[2]||(s[2]=c=>e(l).email=c),placeholder:e(t).translate("input_email_address")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("phone_number"),path:"phone_number"},{default:o(()=>[n(d,{value:e(l).phone_number,"onUpdate:value":s[3]||(s[3]=c=>e(l).phone_number=c),placeholder:e(t).translate("input_phone_number")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("biography"),path:"biography"},{default:o(()=>[n(d,{value:e(l).biography,"onUpdate:value":s[4]||(s[4]=c=>e(l).biography=c),type:"textarea",placeholder:e(t).translate("input_biography")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("movement"),path:"movement_id"},{default:o(()=>[n(A,{value:e(l).movement_id,"onUpdate:value":s[5]||(s[5]=c=>e(l).movement_id=c),clearable:"",placeholder:e(t).translate("select_movement"),options:e(B)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),n(_,{path:"contact_id",label:e(t).translate("contact")},{default:o(()=>[n(A,{loading:e(a),filterable:"",clearable:"",remote:"",onSearch:N,value:e(l).contact_id,"onUpdate:value":s[6]||(s[6]=c=>e(l).contact_id=c),options:e(U),placeholder:e(t).translate("please_select")},{action:o(()=>[n(K,{depth:3},{default:o(()=>[b(w(e(t).translate("loading_maximum_20_users._type_in_the_name_of_the_user_to_search")),1)]),_:1})]),_:1},8,["loading","value","options","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("preferred_language"),path:"preferred_language_id"},{default:o(()=>[n(A,{value:e(l).preferred_language_id,"onUpdate:value":s[7]||(s[7]=c=>e(l).preferred_language_id=c),clearable:"",placeholder:e(t).translate("select_preferred_language"),options:e(v)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),n(Y,{justify:"center"},{default:o(()=>[n(X,{type:"warning",secondary:"",size:"small",onClick:O},{icon:o(()=>[n(Q,{component:e(Re)},null,8,["component"])]),default:o(()=>[b(" "+w(e(t).translate("update")),1)]),_:1})]),_:1})]),_:1},8,["model"]),n(ee),n(_,{label:e(t).translate("change_password"),"label-placement":"left",size:"small"},{default:o(()=>[n(ne)]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})}}});export{an as default};
