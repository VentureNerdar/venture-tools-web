import{u as U,R as k}from"./Z9mtmCOJ.js";import{u as M}from"./CXcOiCMu.js";import{a as V,N as D,b as A,u as oe}from"./BD8ut38M.js";import{Y as le,Z as B,$ as w,a0 as h,a1 as I,d as z,a2 as se,j as N,a3 as re,h as S,R as T,v as P,x as E,y as F,K as j,A as t,B as o,M as e,C as y,z as x,P as H,O as W,a4 as ie,r as L,L as de}from"./CvgJilO_.js";import{_ as ce,u as ue,a as me}from"./CX9ChRIe.js";import{_ as q}from"./Capxcjv2.js";import{_ as pe}from"./CnHNT5Br.js";import{_ as _e,u as fe}from"./BJV2Xrdv.js";import{_ as J}from"./BVZXQxPA.js";import{b as ge}from"./BjVeTqPo.js";import{a as ve,_ as he}from"./BQZ3yDip.js";import{_ as be,a as we}from"./D3CG4WMs.js";import{_ as ye}from"./Dpyx7mFK.js";import{_ as xe}from"./sDTwY0VO.js";import{_ as Ce}from"./BCgcouS8.js";import"./DwBiJwwL.js";import"./B5Y5usd9.js";import"./CMCM9tz_.js";import"./75ykbhQG.js";import"./Bk_rJcZu.js";const Se=le("divider",`
 position: relative;
 display: flex;
 width: 100%;
 box-sizing: border-box;
 font-size: 16px;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
`,[B("vertical",`
 margin-top: 24px;
 margin-bottom: 24px;
 `,[B("no-title",`
 display: flex;
 align-items: center;
 `)]),w("title",`
 display: flex;
 align-items: center;
 margin-left: 12px;
 margin-right: 12px;
 white-space: nowrap;
 font-weight: var(--n-font-weight);
 `),h("title-position-left",[w("line",[h("left",{width:"28px"})])]),h("title-position-right",[w("line",[h("right",{width:"28px"})])]),h("dashed",[w("line",`
 background-color: #0000;
 height: 0px;
 width: 100%;
 border-style: dashed;
 border-width: 1px 0 0;
 `)]),h("vertical",`
 display: inline-block;
 height: 1em;
 margin: 0 8px;
 vertical-align: middle;
 width: 1px;
 `),w("line",`
 border: none;
 transition: background-color .3s var(--n-bezier), border-color .3s var(--n-bezier);
 height: 1px;
 width: 100%;
 margin: 0;
 `),B("dashed",[w("line",{backgroundColor:"var(--n-color)"})]),h("dashed",[w("line",{borderColor:"var(--n-color)"})]),h("vertical",{backgroundColor:"var(--n-color)"})]),Ue=Object.assign(Object.assign({},I.props),{titlePlacement:{type:String,default:"center"},dashed:Boolean,vertical:Boolean}),ke=z({name:"Divider",props:Ue,setup(f){const{mergedClsPrefixRef:_,inlineThemeDisabled:r}=se(f),a=I("Divider","-divider",Se,ge,f,_),n=N(()=>{const{common:{cubicBezierEaseInOut:i},self:{color:u,textColor:v,fontWeight:b}}=a.value;return{"--n-bezier":i,"--n-color":u,"--n-text-color":v,"--n-font-weight":b}}),l=r?re("divider",void 0,n,f):void 0;return{mergedClsPrefix:_,cssVars:r?void 0:n,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender}},render(){var f;const{$slots:_,titlePlacement:r,vertical:a,dashed:n,cssVars:l,mergedClsPrefix:i}=this;return(f=this.onRender)===null||f===void 0||f.call(this),S("div",{role:"separator",class:[`${i}-divider`,this.themeClass,{[`${i}-divider--vertical`]:a,[`${i}-divider--no-title`]:!_.default,[`${i}-divider--dashed`]:n,[`${i}-divider--title-position-${r}`]:_.default&&r}],style:l},a?null:S("div",{class:`${i}-divider__line ${i}-divider__line--left`}),!a&&_.default?S(T,null,S("div",{class:`${i}-divider__title`},this.$slots),S("div",{class:`${i}-divider__line ${i}-divider__line--right`})):null)}}),ze={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Pe=z({name:"CloudUploadRound",render:function(_,r){return P(),E("svg",ze,r[0]||(r[0]=[F("path",{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l4.65-4.65c.2-.2.51-.2.71 0L17 13h-3z",fill:"currentColor"},null,-1)]))}}),$e={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Re=z({name:"WarningRound",render:function(_,r){return P(),E("svg",$e,r[0]||(r[0]=[F("path",{d:"M4.47 21h15.06c1.54 0 2.5-1.67 1.73-3L13.73 4.99c-.77-1.33-2.69-1.33-3.46 0L2.74 18c-.77 1.33.19 3 1.73 3zM12 14c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm1 4h-2v-2h2v2z",fill:"currentColor"},null,-1)]))}}),Oe=z({__name:"ProfileChangePassword",setup(f){const _=M(),r=V(),a={updateProfile:U(k.USERS),changePassword:U(k.PROFILE_CHANGE_PASSWORD,0)},n=j({visibility:{modal:!1,confirm:!1},loading:{form:!1,buttonSave:!1,buttonCancel:!1},form:{current_password:"",new_password:"",confirm_new_password:""}}),l={handle:{click:{button:{modal:()=>{n.visibility.modal=!0},cancel:()=>{n.visibility.modal=!1,l.clearForm()},save:async()=>{n.loading.form=!0,n.loading.buttonSave=!0,n.loading.buttonCancel=!0,await l.consume.changePassword(),n.loading.form=!1,n.loading.buttonSave=!0,n.loading.buttonCancel=!0,n.visibility.modal=!1,l.clearForm()}}}},consume:{changePassword:async()=>{await a.changePassword.save(n.form)!==!1&&_.logout()}},clearForm:()=>{n.form.current_password="",n.form.new_password="",n.form.confirm_new_password=""}};return(i,u)=>{const v=D,b=H,$=ce,C=q,R=pe,d=_e,s=J,c=W,m=ie;return P(),E(T,null,[t(b,{type:"error",secondary:"",onClick:l.handle.click.button.modal},{icon:o(()=>[t(v,{component:e(Re)},null,8,["component"])]),default:o(()=>[y(" "+x(e(r).translate("change_password")),1)]),_:1},8,["onClick"]),t(m,{show:e(n).visibility.modal,"onUpdate:show":u[3]||(u[3]=g=>e(n).visibility.modal=g),"transform-origin":"center"},{default:o(()=>[t(c,{style:{width:"600px"},title:e(r).translate("change_password"),size:"small",role:"dialog","aria-modal":"true"},{footer:o(()=>[t(s,{justify:"end"},{default:o(()=>[t(b,{type:"default",size:"small",disabled:e(n).loading.buttonCancel,onClick:l.handle.click.button.cancel},{default:o(()=>[y(x(e(r).translate("cancel")),1)]),_:1},8,["disabled","onClick"]),t(b,{type:"primary",size:"small",disabled:e(n).loading.buttonSave,loading:e(n).loading.buttonSave,onClick:l.handle.click.button.save},{default:o(()=>[y(x(e(r).translate("save")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),default:o(()=>[t(d,{show:e(n).loading.form},{default:o(()=>[t(R,{size:10,vertical:""},{default:o(()=>[t($,{title:e(r).translate("you_will_need_to_log_in_again_after_you_chang_your_password"),type:"info"},null,8,["title"]),t(C,{size:"small",value:e(n).form.current_password,"onUpdate:value":u[0]||(u[0]=g=>e(n).form.current_password=g),type:"password",placeholder:e(r).translate("current_password")},null,8,["value","placeholder"]),t(C,{size:"small",value:e(n).form.new_password,"onUpdate:value":u[1]||(u[1]=g=>e(n).form.new_password=g),type:"password",placeholder:e(r).translate("new_password")},null,8,["value","placeholder"]),t(C,{size:"small",value:e(n).form.confirm_new_password,"onUpdate:value":u[2]||(u[2]=g=>e(n).form.confirm_new_password=g),type:"password",placeholder:e(r).translate("confirm_new_password")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["show"])]),_:1},8,["title"])]),_:1},8,["show"])],64)}}}),Qe=z({__name:"profile",setup(f){const _=M(),r=L(null),a=L({..._.authUser}),n=V(),l=j({loading:{movements:!1,contacts:!1},options:{movements:[],contacts:[]}}),i={roles:fe(),languages:A().languages,settingStore:oe(),movementStore:ue(),contacts:me().contacts},u={movements:U(k.MOVEMENTS),contacts:U(k.CONTACTS)},v={handle:{searchMovementsOption:async d=>{l.loading.movements=!0;const s=await u.movements.browse({all:!0,search_by:"name",search:d},!1);l.options.movements=[...s.map(c=>({label:c.name,value:c.id}))],l.loading.movements=!1},searchContactsOption:async d=>{l.loading.contacts=!0;const s=await u.contacts.browse({all:!0,search_by:"name",search:d},!1);l.options.contacts=[...s.map(c=>({label:c.name,value:c.id}))],l.loading.contacts=!1}},movementOptions:async()=>{const d=await u.movements.list({labelOption:"name",limit:20,existingID:a.value.movement_id});l.options.movements=[...d]},contactOptions:async()=>{const d=await u.contacts.list({labelOption:"name",limit:20,existingID:a.value.contact_id});l.options.contacts=[...d]}},b={user:{name:{required:!0,message:"Please input your name",trigger:"blur"},age:{required:!0,message:"Please input your age",trigger:["input","blur"]}},phone:{required:!0,message:"Please input your number",trigger:["input"]}},$=N(()=>A().languages.map(d=>({label:d.name,value:d.id}))),C=N(()=>{var d;return(d=i.roles.userRoles.find(s=>s.id===a.value.user_role_id))==null?void 0:d.label}),R=async()=>{await U(k.USERS,_.authUser.id).save(a.value);const c={...JSON.parse(localStorage.getItem("authUser")||"{}"),...a.value};M().authUser=c,localStorage.setItem("authUser",JSON.stringify(c));const m=i.languages.find(g=>g.id===a.value.preferred_language_id);m&&i.settingStore.setUserPreferredLanguage(m)};return v.movementOptions(),v.contactOptions(),(d,s)=>{const c=q,m=be,g=ye,O=xe,G=Ce,K=D,Y=H,Z=J,Q=we,X=ke,ee=Oe,ne=W,te=he,ae=ve;return P(),de(ae,{"y-gap":"10",cols:"5"},{default:o(()=>[t(te,{offset:1,span:3},{default:o(()=>[t(ne,{size:"small"},{default:o(()=>[t(Q,{ref_key:"formRef",ref:r,"label-width":80,model:e(a),rules:b,size:"small"},{default:o(()=>[t(m,{label:e(n).translate("name"),path:"name"},{default:o(()=>[t(c,{value:e(a).name,"onUpdate:value":s[0]||(s[0]=p=>e(a).name=p),placeholder:e(n).translate("input_name")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(m,{label:e(n).translate("role"),path:"user_role_id"},{default:o(()=>[t(g,{type:"info"},{default:o(()=>[y(x(e(C)),1)]),_:1})]),_:1},8,["label"]),t(m,{label:e(n).translate("username"),path:"username"},{default:o(()=>[t(c,{value:e(a).username,"onUpdate:value":s[1]||(s[1]=p=>e(a).username=p),placeholder:e(n).translate("input_username")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(m,{label:e(n).translate("email_address"),path:"email"},{default:o(()=>[t(c,{value:e(a).email,"onUpdate:value":s[2]||(s[2]=p=>e(a).email=p),placeholder:e(n).translate("input_email_address")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(m,{label:e(n).translate("phone_number"),path:"phone_number"},{default:o(()=>[t(c,{value:e(a).phone_number,"onUpdate:value":s[3]||(s[3]=p=>e(a).phone_number=p),placeholder:e(n).translate("input_phone_number")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(m,{label:e(n).translate("biography"),path:"biography"},{default:o(()=>[t(c,{value:e(a).biography,"onUpdate:value":s[4]||(s[4]=p=>e(a).biography=p),type:"textarea",placeholder:e(n).translate("input_biography")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(m,{label:e(n).translate("movement"),path:"movement_id"},{default:o(()=>[t(O,{value:e(a).movement_id,"onUpdate:value":s[5]||(s[5]=p=>e(a).movement_id=p),filterable:"",clearable:"",remote:"",placeholder:e(n).translate("select_movement"),options:e(l).options.movements,onSearch:v.handle.searchMovementsOption},null,8,["value","placeholder","options","onSearch"])]),_:1},8,["label"]),t(m,{path:"contact_id",label:e(n).translate("contact")},{default:o(()=>[t(O,{loading:e(l).loading.contacts,filterable:"",clearable:"",remote:"",onSearch:v.contactOptions,value:e(a).contact_id,"onUpdate:value":s[6]||(s[6]=p=>e(a).contact_id=p),options:e(l).options.contacts,placeholder:e(n).translate("please_select")},{action:o(()=>[t(G,{depth:3},{default:o(()=>[y(x(e(n).translate("loading_maximum_20_users._type_in_the_name_of_the_user_to_search")),1)]),_:1})]),_:1},8,["loading","onSearch","value","options","placeholder"])]),_:1},8,["label"]),t(m,{label:e(n).translate("preferred_language"),path:"preferred_language_id"},{default:o(()=>[t(O,{value:e(a).preferred_language_id,"onUpdate:value":s[7]||(s[7]=p=>e(a).preferred_language_id=p),clearable:"",placeholder:e(n).translate("select_preferred_language"),options:e($)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(Z,{justify:"center"},{default:o(()=>[t(Y,{type:"warning",secondary:"",size:"small",onClick:R},{icon:o(()=>[t(K,{component:e(Pe)},null,8,["component"])]),default:o(()=>[y(" "+x(e(n).translate("update")),1)]),_:1})]),_:1})]),_:1},8,["model"]),t(X),t(m,{label:e(n).translate("change_password"),"label-placement":"left",size:"small"},{default:o(()=>[t(ee)]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})}}});export{Qe as default};
