import{u as P,R as $}from"./CIn3Frgy.js";import{u as E}from"./CjcVE08U.js";import{a as T,b as F,u as le}from"./B9foOY_i.js";import{Y as re,Z as M,$ as h,a0 as g,a1 as j,d as S,a2 as se,j as z,a3 as ie,h as C,R as D,v as R,x as V,y as I,K as de,A as n,B as o,M as e,C as b,z as w,P as H,O as W,a4 as ue,r as k,L as pe}from"./C8B0pVqp.js";import{N as q}from"./BgmrUE6R.js";import{_ as ce,u as _e,a as me}from"./CXBoYoBN.js";import{_ as J}from"./Cwtkx9cy.js";import{_ as fe}from"./DShXsbGp.js";import{_ as ge}from"./BsqA9Ioi.js";import{_ as G}from"./BccNmMnX.js";import{u as ve}from"./BEPCnN3O.js";import{b as he}from"./DT4rYR05.js";import{a as be,_ as we}from"./CIkThKCN.js";import{_ as ye,a as xe}from"./CdmtH_el.js";import{_ as Ce}from"./C27MwKPy.js";import{_ as Se}from"./s6TOlJXo.js";import{_ as Ue}from"./C2UEqYWv.js";import"./D9PDig5o.js";import"./B-p6aW7q.js";import"./BzyrSvOY.js";import"./B3-gLStb.js";import"./DEhmi0Uk.js";import"./CdyTBPJQ.js";import"./Bk_rJcZu.js";import"./C5Ksf8W7.js";import"./EwO3xgms.js";const ke=re("divider",`
 position: relative;
 display: flex;
 width: 100%;
 box-sizing: border-box;
 font-size: 16px;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
`,[M("vertical",`
 margin-top: 24px;
 margin-bottom: 24px;
 `,[M("no-title",`
 display: flex;
 align-items: center;
 `)]),h("title",`
 display: flex;
 align-items: center;
 margin-left: 12px;
 margin-right: 12px;
 white-space: nowrap;
 font-weight: var(--n-font-weight);
 `),g("title-position-left",[h("line",[g("left",{width:"28px"})])]),g("title-position-right",[h("line",[g("right",{width:"28px"})])]),g("dashed",[h("line",`
 background-color: #0000;
 height: 0px;
 width: 100%;
 border-style: dashed;
 border-width: 1px 0 0;
 `)]),g("vertical",`
 display: inline-block;
 height: 1em;
 margin: 0 8px;
 vertical-align: middle;
 width: 1px;
 `),h("line",`
 border: none;
 transition: background-color .3s var(--n-bezier), border-color .3s var(--n-bezier);
 height: 1px;
 width: 100%;
 margin: 0;
 `),M("dashed",[h("line",{backgroundColor:"var(--n-color)"})]),g("dashed",[h("line",{borderColor:"var(--n-color)"})]),g("vertical",{backgroundColor:"var(--n-color)"})]),ze=Object.assign(Object.assign({},j.props),{titlePlacement:{type:String,default:"center"},dashed:Boolean,vertical:Boolean}),Pe=S({name:"Divider",props:ze,setup(f){const{mergedClsPrefixRef:c,inlineThemeDisabled:s}=se(f),l=j("Divider","-divider",ke,he,f,c),a=z(()=>{const{common:{cubicBezierEaseInOut:i},self:{color:m,textColor:y,fontWeight:v}}=l.value;return{"--n-bezier":i,"--n-color":m,"--n-text-color":y,"--n-font-weight":v}}),t=s?ie("divider",void 0,a,f):void 0;return{mergedClsPrefix:c,cssVars:s?void 0:a,themeClass:t==null?void 0:t.themeClass,onRender:t==null?void 0:t.onRender}},render(){var f;const{$slots:c,titlePlacement:s,vertical:l,dashed:a,cssVars:t,mergedClsPrefix:i}=this;return(f=this.onRender)===null||f===void 0||f.call(this),C("div",{role:"separator",class:[`${i}-divider`,this.themeClass,{[`${i}-divider--vertical`]:l,[`${i}-divider--no-title`]:!c.default,[`${i}-divider--dashed`]:a,[`${i}-divider--title-position-${s}`]:c.default&&s}],style:t},l?null:C("div",{class:`${i}-divider__line ${i}-divider__line--left`}),!l&&c.default?C(D,null,C("div",{class:`${i}-divider__title`},this.$slots),C("div",{class:`${i}-divider__line ${i}-divider__line--right`})):null)}}),$e={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Re=S({name:"CloudUploadRound",render:function(c,s){return R(),V("svg",$e,s[0]||(s[0]=[I("path",{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l4.65-4.65c.2-.2.51-.2.71 0L17 13h-3z",fill:"currentColor"},null,-1)]))}}),Oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Be=S({name:"WarningRound",render:function(c,s){return R(),V("svg",Oe,s[0]||(s[0]=[I("path",{d:"M4.47 21h15.06c1.54 0 2.5-1.67 1.73-3L13.73 4.99c-.77-1.33-2.69-1.33-3.46 0L2.74 18c-.77 1.33.19 3 1.73 3zM12 14c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm1 4h-2v-2h2v2z",fill:"currentColor"},null,-1)]))}}),Ne=S({__name:"ProfileChangePassword",setup(f){const c=E(),s=T(),l={updateProfile:P($.USERS),changePassword:P($.PROFILE_CHANGE_PASSWORD,0)},a=de({visibility:{modal:!1,confirm:!1},loading:{form:!1,buttonSave:!1,buttonCancel:!1},form:{current_password:"",new_password:"",confirm_new_password:""}}),t={handle:{click:{button:{modal:()=>{a.visibility.modal=!0},cancel:()=>{a.visibility.modal=!1,t.clearForm()},save:async()=>{a.loading.form=!0,a.loading.buttonSave=!0,a.loading.buttonCancel=!0,await t.consume.changePassword(),a.loading.form=!1,a.loading.buttonSave=!0,a.loading.buttonCancel=!0,a.visibility.modal=!1,t.clearForm()}}}},consume:{changePassword:async()=>{await l.changePassword.save(a.form)!==!1&&c.logout()}},clearForm:()=>{a.form.current_password="",a.form.new_password="",a.form.confirm_new_password=""}};return(i,m)=>{const y=q,v=H,U=ce,x=J,O=fe,B=ge,N=G,u=W,r=ue;return R(),V(D,null,[n(v,{type:"error",secondary:"",onClick:t.handle.click.button.modal},{icon:o(()=>[n(y,{component:e(Be)},null,8,["component"])]),default:o(()=>[b(" "+w(e(s).translate("change_password")),1)]),_:1},8,["onClick"]),n(r,{show:e(a).visibility.modal,"onUpdate:show":m[3]||(m[3]=d=>e(a).visibility.modal=d),"transform-origin":"center"},{default:o(()=>[n(u,{style:{width:"600px"},title:e(s).translate("change_password"),size:"small",role:"dialog","aria-modal":"true"},{footer:o(()=>[n(N,{justify:"end"},{default:o(()=>[n(v,{type:"default",size:"small",disabled:e(a).loading.buttonCancel,onClick:t.handle.click.button.cancel},{default:o(()=>[b(w(e(s).translate("cancel")),1)]),_:1},8,["disabled","onClick"]),n(v,{type:"primary",size:"small",disabled:e(a).loading.buttonSave,loading:e(a).loading.buttonSave,onClick:t.handle.click.button.save},{default:o(()=>[b(w(e(s).translate("save")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),default:o(()=>[n(B,{show:e(a).loading.form},{default:o(()=>[n(O,{size:10,vertical:""},{default:o(()=>[n(U,{title:e(s).translate("you_will_need_to_log_in_again_after_you_chang_your_password"),type:"info"},null,8,["title"]),n(x,{size:"small",value:e(a).form.current_password,"onUpdate:value":m[0]||(m[0]=d=>e(a).form.current_password=d),type:"password",placeholder:e(s).translate("current_password")},null,8,["value","placeholder"]),n(x,{size:"small",value:e(a).form.new_password,"onUpdate:value":m[1]||(m[1]=d=>e(a).form.new_password=d),type:"password",placeholder:e(s).translate("new_password")},null,8,["value","placeholder"]),n(x,{size:"small",value:e(a).form.confirm_new_password,"onUpdate:value":m[2]||(m[2]=d=>e(a).form.confirm_new_password=d),type:"password",placeholder:e(s).translate("confirm_new_password")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["show"])]),_:1},8,["title"])]),_:1},8,["show"])],64)}}}),rn=S({__name:"profile",setup(f){const c=E(),s=k(null),l=k({...c.authUser}),a=k(!1),t=T(),i={roles:ve(),languages:F().languages,settingStore:le(),movements:_e().movements,contacts:me().contacts},m={contacts:P($.CONTACTS)},y={user:{name:{required:!0,message:"Please input your name",trigger:"blur"},age:{required:!0,message:"Please input your age",trigger:["input","blur"]}},phone:{required:!0,message:"Please input your number",trigger:["input"]}},v=z(()=>F().languages.map(u=>({label:u.name,value:u.id}))),U=k(i.contacts.map(u=>({label:u.name,value:u.id}))),x=z(()=>{var u;return(u=i.roles.userRoles.find(r=>r.id===l.value.user_role_id))==null?void 0:u.label}),O=z(()=>i.movements.map(u=>({label:u.name,value:u.id}))),B=async u=>{a.value=!0;const r=await m.contacts.browse({all:!0,search_by:"name",search:u},!1);U.value=[...r.map(d=>({label:d.name,value:d.id}))],a.value=!1},N=async()=>{await P($.USERS,c.authUser.id).save(l.value);const d={...JSON.parse(localStorage.getItem("authUser")||"{}"),...l.value};E().authUser=d,localStorage.setItem("authUser",JSON.stringify(d));const _=i.languages.find(L=>L.id===l.value.preferred_language_id);_&&i.settingStore.setUserPreferredLanguage(_)};return(u,r)=>{const d=J,_=ye,L=Ce,A=Se,K=Ue,Y=q,Z=H,Q=G,X=xe,ee=Pe,ne=Ne,te=W,ae=we,oe=be;return R(),pe(oe,{"y-gap":"10",cols:"5"},{default:o(()=>[n(ae,{offset:1,span:3},{default:o(()=>[n(te,{size:"small"},{default:o(()=>[n(X,{ref_key:"formRef",ref:s,"label-width":80,model:e(l),rules:y,size:"small"},{default:o(()=>[n(_,{label:e(t).translate("name"),path:"name"},{default:o(()=>[n(d,{value:e(l).name,"onUpdate:value":r[0]||(r[0]=p=>e(l).name=p),placeholder:e(t).translate("input_name")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("role"),path:"user_role_id"},{default:o(()=>[n(L,{type:"info"},{default:o(()=>[b(w(e(x)),1)]),_:1})]),_:1},8,["label"]),n(_,{label:e(t).translate("username"),path:"username"},{default:o(()=>[n(d,{value:e(l).username,"onUpdate:value":r[1]||(r[1]=p=>e(l).username=p),placeholder:e(t).translate("input_username")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("email_address"),path:"email"},{default:o(()=>[n(d,{value:e(l).email,"onUpdate:value":r[2]||(r[2]=p=>e(l).email=p),placeholder:e(t).translate("input_email_address")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("phone_number"),path:"phone_number"},{default:o(()=>[n(d,{value:e(l).phone_number,"onUpdate:value":r[3]||(r[3]=p=>e(l).phone_number=p),placeholder:e(t).translate("input_phone_number")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("biography"),path:"biography"},{default:o(()=>[n(d,{value:e(l).biography,"onUpdate:value":r[4]||(r[4]=p=>e(l).biography=p),type:"textarea",placeholder:e(t).translate("input_biography")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("movement"),path:"movement_id"},{default:o(()=>[n(A,{value:e(l).movement_id,"onUpdate:value":r[5]||(r[5]=p=>e(l).movement_id=p),clearable:"",placeholder:e(t).translate("select_movement"),options:e(O)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),n(_,{path:"contact_id",label:e(t).translate("contact")},{default:o(()=>[n(A,{loading:e(a),filterable:"",clearable:"",remote:"",onSearch:B,value:e(l).contact_id,"onUpdate:value":r[6]||(r[6]=p=>e(l).contact_id=p),options:e(U),placeholder:e(t).translate("please_select")},{action:o(()=>[n(K,{depth:3},{default:o(()=>[b(w(e(t).translate("loading_maximum_20_users._type_in_the_name_of_the_user_to_search")),1)]),_:1})]),_:1},8,["loading","value","options","placeholder"])]),_:1},8,["label"]),n(_,{label:e(t).translate("preferred_language"),path:"preferred_language_id"},{default:o(()=>[n(A,{value:e(l).preferred_language_id,"onUpdate:value":r[7]||(r[7]=p=>e(l).preferred_language_id=p),clearable:"",placeholder:e(t).translate("select_preferred_language"),options:e(v)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),n(Q,{justify:"center"},{default:o(()=>[n(Z,{type:"warning",secondary:"",size:"small",onClick:N},{icon:o(()=>[n(Y,{component:e(Re)},null,8,["component"])]),default:o(()=>[b(" "+w(e(t).translate("update")),1)]),_:1})]),_:1})]),_:1},8,["model"]),n(ee),n(_,{label:e(t).translate("change_password"),"label-placement":"left",size:"small"},{default:o(()=>[n(ne)]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})}}});export{rn as default};
