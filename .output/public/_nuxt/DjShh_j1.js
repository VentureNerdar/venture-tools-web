import{N as U,a as I}from"./uIL8cNz8.js";import{u as S}from"./gyiM1FLU.js";import{D as q}from"./BHAto0Lz.js";import{m as k,r as h,D as B,q as w,B as T,g as D,o as C,p as F,w as m,a as N,b as c,u as e,z as M,v as O,_ as E,d as z,t as A,c as $,H as V}from"./C3GBaIMR.js";import{_ as P}from"./kEuzV1vi.js";import{_ as H}from"./DbIecERV.js";import{_ as j,a as J}from"./Nkn1MGH-.js";import{R as x,u as R}from"./CLiROxXA.js";import{b as W}from"./ykMTbCI-.js";import"./uvMM--wM.js";import"./Bd6li31J.js";import"./CaX1kx0j.js";import"./OznM7iKs.js";import"./CVRue05_.js";import"./DueAUOn6.js";import"./CAHG2to6.js";const G={class:"notification-table"},K=k({__name:"Table",props:{data:{type:Array,required:!0,default:()=>[]}},emits:["row-click","delete-row"],setup(g,{emit:l}){const n=l,_=g,s=h([]),a=I(),{isMobile:d}=S(),f=B(()=>{const o=[{title:a.translate("title"),width:200,key:"title"},{title:"",key:"actions",width:100,render(r){return w(T,{size:"small",type:"error",strong:!0,onClick:i=>{i.stopPropagation(),n("delete-row",r)}},{icon:()=>w(U,null,{default:()=>w(q)})})}}];return d||o.push({title:a.translate("body"),width:300,key:"body"}),o}),b=o=>({style:"cursor: pointer;",onClick:()=>{n("row-click",o)}});return D(()=>_.data,o=>{s.value=o}),(o,r)=>{const i=P,t=O;return C(),F(t,{size:"small",class:M({container:!e(d)})},{default:m(()=>[N("div",G,[c(i,{columns:e(f),data:e(s),bordered:!1,pagination:!1,"row-props":b,"max-height":"calc(100vh - 304px)"},null,8,["columns","data"])])]),_:1},8,["class"])}}}),L=E(K,[["__scopeId","data-v-9dc8b4e4"]]),Q=k({__name:"Form",props:{form:{type:Object,default:()=>({})}},emits:["update:form"],setup(g,{emit:l}){const n=g,_=l,s=I(),a=h({title:n.form.title,body:n.form.body}),d=h(null);D(()=>n.form,o=>{a.value.title=o.title,a.value.body=o.body},{deep:!0});const f={title:{required:!0,message:s.translate("title_is_required"),trigger:"blur"},body:{required:!0,message:s.translate("body_is_required"),trigger:"blur"}},b=o=>{var r;o.preventDefault(),(r=d.value)==null||r.validate(i=>{i||_("update:form",a.value)})};return(o,r)=>{const i=H,t=j,p=T,u=J,v=O;return C(),F(v,null,{default:m(()=>[c(u,{model:e(a),rules:f,ref_key:"formRef",ref:d},{default:m(()=>[c(t,{label:e(s).translate("title"),prop:"title",path:"title"},{default:m(()=>[c(i,{value:e(a).title,"onUpdate:value":r[0]||(r[0]=y=>e(a).title=y),placeholder:e(s).translate("please_input")},null,8,["value","placeholder"])]),_:1},8,["label"]),c(t,{label:e(s).translate("body"),prop:"body",path:"body"},{default:m(()=>[c(i,{value:e(a).body,"onUpdate:value":r[1]||(r[1]=y=>e(a).body=y),placeholder:e(s).translate("please_input")},null,8,["value","placeholder"])]),_:1},8,["label"]),c(t,null,{default:m(()=>[c(p,{type:"primary",onClick:b},{default:m(()=>[z(A(e(s).translate("send")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),X={class:"form-container"},Y=k({__name:"notifications",setup(g){const l=h({title:"",body:""}),n=h([]),_=W(),{isMobile:s}=S(),a=t=>{l.value.title=t.title,l.value.body=t.body},d=x.MOVEMENT_NOTIFICATIONS,f=R(d),b={all:!0,limit:20,where:JSON.stringify([{key:"user_id",value:_.authUser.id}])},o=async()=>{try{const t=await f.browse(b,!1);n.value=t,console.log(n.value)}catch(t){console.error("Error fetching notification:",t)}},r=async t=>{const p={...t,user_id:_.authUser.id};try{console.log("Form updated Final:",p);const u=await f.save(p);u&&(n.value.unshift(u),l.value={title:"",body:""})}catch(u){console.error("Error saving notification:",u)}},i=async t=>{console.log("Deleting row:",t),await R(x.MOVEMENT_NOTIFICATIONS,t.id).delete(!0)&&(n.value=n.value.filter(v=>v.id!==t.id))};return o(),(t,p)=>{const u=L,v=Q;return C(),$("div",{class:M(e(s)?"mobile-container":"desktop-container")},[N("div",null,[c(u,{data:e(n),onRowClick:a,onDeleteRow:i},null,8,["data"])]),N("div",X,[c(v,{form:e(l),"onUpdate:form":[p[0]||(p[0]=y=>V(l)?l.value=y:null),r]},null,8,["form"])])],2)}}}),ft=E(Y,[["__scopeId","data-v-cc637c55"]]);export{ft as default};
