import{u as R,R as B}from"./C3Vc6WMm.js";import{u as N}from"./DqqJ92NX.js";import{a as E,b as V,u as Z}from"./D7saD_mM.js";import{V as ee,W as $,X as b,Y as v,Z as M,d as z,$ as ne,j as L,a0 as oe,h as C,N as F,v as S,x as O,y as j,K as te,A as o,B as a,M as e,C as P,z as k,Q as D,S as I,a1 as ae,r as A,L as le}from"./B7JTAmbj.js";import{N as W}from"./Dv_E6hVM.js";import{_ as re}from"./r_snL_2h.js";import{_ as H}from"./DLjqJwYW.js";import{_ as se}from"./BofTYrqP.js";import{_ as ie,u as de}from"./Bv1wHbdW.js";import{_ as T}from"./CLK0QgWg.js";import{b as ue}from"./BIgXSGoV.js";import{_ as pe,a as ce}from"./BGZYJQMR.js";import{_ as _e,a as me}from"./CUFHnPjY.js";import{_ as fe}from"./CQjqiYHC.js";import{_ as ge}from"./D5OJSPh6.js";import"./Df9D1ddC.js";import"./C9SsEAV0.js";import"./B-p6aW7q.js";import"./CuBazJS9.js";import"./DhBh0zKe.js";import"./Bk_rJcZu.js";import"./oRb5DLYm.js";const ve=ee("divider",`
 position: relative;
 display: flex;
 width: 100%;
 box-sizing: border-box;
 font-size: 16px;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
`,[$("vertical",`
 margin-top: 24px;
 margin-bottom: 24px;
 `,[$("no-title",`
 display: flex;
 align-items: center;
 `)]),b("title",`
 display: flex;
 align-items: center;
 margin-left: 12px;
 margin-right: 12px;
 white-space: nowrap;
 font-weight: var(--n-font-weight);
 `),v("title-position-left",[b("line",[v("left",{width:"28px"})])]),v("title-position-right",[b("line",[v("right",{width:"28px"})])]),v("dashed",[b("line",`
 background-color: #0000;
 height: 0px;
 width: 100%;
 border-style: dashed;
 border-width: 1px 0 0;
 `)]),v("vertical",`
 display: inline-block;
 height: 1em;
 margin: 0 8px;
 vertical-align: middle;
 width: 1px;
 `),b("line",`
 border: none;
 transition: background-color .3s var(--n-bezier), border-color .3s var(--n-bezier);
 height: 1px;
 width: 100%;
 margin: 0;
 `),$("dashed",[b("line",{backgroundColor:"var(--n-color)"})]),v("dashed",[b("line",{borderColor:"var(--n-color)"})]),v("vertical",{backgroundColor:"var(--n-color)"})]),he=Object.assign(Object.assign({},M.props),{titlePlacement:{type:String,default:"center"},dashed:Boolean,vertical:Boolean}),be=z({name:"Divider",props:he,setup(c){const{mergedClsPrefixRef:d,inlineThemeDisabled:l}=ne(c),t=M("Divider","-divider",ve,ue,c,d),n=L(()=>{const{common:{cubicBezierEaseInOut:i},self:{color:p,textColor:y,fontWeight:h}}=t.value;return{"--n-bezier":i,"--n-color":p,"--n-text-color":y,"--n-font-weight":h}}),s=l?oe("divider",void 0,n,c):void 0;return{mergedClsPrefix:d,cssVars:l?void 0:n,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var c;const{$slots:d,titlePlacement:l,vertical:t,dashed:n,cssVars:s,mergedClsPrefix:i}=this;return(c=this.onRender)===null||c===void 0||c.call(this),C("div",{role:"separator",class:[`${i}-divider`,this.themeClass,{[`${i}-divider--vertical`]:t,[`${i}-divider--no-title`]:!d.default,[`${i}-divider--dashed`]:n,[`${i}-divider--title-position-${l}`]:d.default&&l}],style:s},t?null:C("div",{class:`${i}-divider__line ${i}-divider__line--left`}),!t&&d.default?C(F,null,C("div",{class:`${i}-divider__title`},this.$slots),C("div",{class:`${i}-divider__line ${i}-divider__line--right`})):null)}}),we={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ye=z({name:"CloudUploadRound",render:function(d,l){return S(),O("svg",we,l[0]||(l[0]=[j("path",{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l4.65-4.65c.2-.2.51-.2.71 0L17 13h-3z",fill:"currentColor"},null,-1)]))}}),xe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ce=z({name:"WarningRound",render:function(d,l){return S(),O("svg",xe,l[0]||(l[0]=[j("path",{d:"M4.47 21h15.06c1.54 0 2.5-1.67 1.73-3L13.73 4.99c-.77-1.33-2.69-1.33-3.46 0L2.74 18c-.77 1.33.19 3 1.73 3zM12 14c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm1 4h-2v-2h2v2z",fill:"currentColor"},null,-1)]))}}),Pe=z({__name:"ProfileChangePassword",setup(c){const d=N(),l=E(),t={updateProfile:R(B.USERS),changePassword:R(B.PROFILE_CHANGE_PASSWORD,0)},n=te({visibility:{modal:!1,confirm:!1},loading:{form:!1,buttonSave:!1,buttonCancel:!1},form:{current_password:"",new_password:"",confirm_new_password:""}}),s={handle:{click:{button:{modal:()=>{n.visibility.modal=!0},cancel:()=>{n.visibility.modal=!1,s.clearForm()},save:async()=>{n.loading.form=!0,n.loading.buttonSave=!0,n.loading.buttonCancel=!0,await s.consume.changePassword(),n.loading.form=!1,n.loading.buttonSave=!0,n.loading.buttonCancel=!0,n.visibility.modal=!1,s.clearForm()}}}},consume:{changePassword:async()=>{await t.changePassword.save(n.form)!==!1&&d.logout()}},clearForm:()=>{n.form.current_password="",n.form.new_password="",n.form.confirm_new_password=""}};return(i,p)=>{const y=W,h=D,m=re,r=H,g=se,u=ie,w=T,x=I,U=ae;return S(),O(F,null,[o(h,{type:"error",secondary:"",onClick:s.handle.click.button.modal},{icon:a(()=>[o(y,{component:e(Ce)},null,8,["component"])]),default:a(()=>[P(" "+k(e(l).translate("change_password")),1)]),_:1},8,["onClick"]),o(U,{show:e(n).visibility.modal,"onUpdate:show":p[3]||(p[3]=f=>e(n).visibility.modal=f),"transform-origin":"center"},{default:a(()=>[o(x,{style:{width:"600px"},title:e(l).translate("change_password"),size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[o(w,{justify:"end"},{default:a(()=>[o(h,{type:"default",size:"small",disabled:e(n).loading.buttonCancel,onClick:s.handle.click.button.cancel},{default:a(()=>[P(k(e(l).translate("cancel")),1)]),_:1},8,["disabled","onClick"]),o(h,{type:"primary",size:"small",disabled:e(n).loading.buttonSave,loading:e(n).loading.buttonSave,onClick:s.handle.click.button.save},{default:a(()=>[P(k(e(l).translate("save")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),default:a(()=>[o(u,{show:e(n).loading.form},{default:a(()=>[o(g,{size:10,vertical:""},{default:a(()=>[o(m,{title:e(l).translate("you_will_need_to_log_in_again_after_you_chang_your_password"),type:"info"},null,8,["title"]),o(r,{size:"small",value:e(n).form.current_password,"onUpdate:value":p[0]||(p[0]=f=>e(n).form.current_password=f),type:"password",placeholder:e(l).translate("current_password")},null,8,["value","placeholder"]),o(r,{size:"small",value:e(n).form.new_password,"onUpdate:value":p[1]||(p[1]=f=>e(n).form.new_password=f),type:"password",placeholder:e(l).translate("new_password")},null,8,["value","placeholder"]),o(r,{size:"small",value:e(n).form.confirm_new_password,"onUpdate:value":p[2]||(p[2]=f=>e(n).form.confirm_new_password=f),type:"password",placeholder:e(l).translate("confirm_new_password")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["show"])]),_:1},8,["title"])]),_:1},8,["show"])],64)}}}),Je=z({__name:"profile",setup(c){const d=N(),l=A(null),t=A({...d.authUser}),n=E(),s={roles:de(),languages:V().languages,settingStore:Z()},i={user:{name:{required:!0,message:"Please input your name",trigger:"blur"},age:{required:!0,message:"Please input your age",trigger:["input","blur"]}},phone:{required:!0,message:"Please input your number",trigger:["input"]}},p=L(()=>V().languages.map(m=>({label:m.name,value:m.id}))),y=L(()=>{var m;return(m=s.roles.userRoles.find(r=>r.id===t.value.user_role_id))==null?void 0:m.label}),h=async()=>{console.log("handleProfileUpdate",t.value);const r=await R(B.USERS,d.authUser.id).save(t.value);console.log("Profile res",r);const u={...JSON.parse(localStorage.getItem("authUser")||"{}"),...t.value};N().authUser=u,localStorage.setItem("authUser",JSON.stringify(u));const w=s.languages.find(x=>x.id===t.value.preferred_language_id);w&&s.settingStore.setUserPreferredLanguage(w)};return(m,r)=>{const g=H,u=_e,w=fe,x=ge,U=W,f=D,q=T,J=me,G=be,K=Pe,Q=I,X=ce,Y=pe;return S(),le(Y,{"y-gap":"10",cols:"5"},{default:a(()=>[o(X,{offset:1,span:3},{default:a(()=>[o(Q,{size:"small"},{default:a(()=>[o(J,{ref_key:"formRef",ref:l,"label-width":80,model:e(t),rules:i,size:"small"},{default:a(()=>[o(u,{label:e(n).translate("name"),path:"name"},{default:a(()=>[o(g,{value:e(t).name,"onUpdate:value":r[0]||(r[0]=_=>e(t).name=_),placeholder:e(n).translate("input_name")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(u,{label:e(n).translate("role"),path:"user_role_id"},{default:a(()=>[o(w,{type:"info"},{default:a(()=>[P(k(e(y)),1)]),_:1})]),_:1},8,["label"]),o(u,{label:e(n).translate("username"),path:"username"},{default:a(()=>[o(g,{value:e(t).username,"onUpdate:value":r[1]||(r[1]=_=>e(t).username=_),placeholder:e(n).translate("input_username")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(u,{label:e(n).translate("email_address"),path:"email"},{default:a(()=>[o(g,{value:e(t).email,"onUpdate:value":r[2]||(r[2]=_=>e(t).email=_),placeholder:e(n).translate("input_email_address")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(u,{label:e(n).translate("phone_number"),path:"phone_number"},{default:a(()=>[o(g,{value:e(t).phone_number,"onUpdate:value":r[3]||(r[3]=_=>e(t).phone_number=_),placeholder:e(n).translate("input_phone_number")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(u,{label:e(n).translate("biography"),path:"biography"},{default:a(()=>[o(g,{value:e(t).biography,"onUpdate:value":r[4]||(r[4]=_=>e(t).biography=_),type:"textarea",placeholder:e(n).translate("input_biography")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(u,{label:e(n).translate("preferred_language"),path:"preferred_language_id"},{default:a(()=>[o(x,{value:e(t).preferred_language_id,"onUpdate:value":r[5]||(r[5]=_=>e(t).preferred_language_id=_),clearable:"",placeholder:e(n).translate("select_preferred_language"),options:e(p)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),o(q,{justify:"center"},{default:a(()=>[o(f,{type:"warning",secondary:"",size:"small",onClick:h},{icon:a(()=>[o(U,{component:e(ye)},null,8,["component"])]),default:a(()=>[P(" "+k(e(n).translate("update")),1)]),_:1})]),_:1})]),_:1},8,["model"]),o(G),o(u,{label:e(n).translate("change_password"),"label-placement":"left",size:"small"},{default:a(()=>[o(K)]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})}}});export{Je as default};
